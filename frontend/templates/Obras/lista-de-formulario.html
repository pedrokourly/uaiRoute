{% extends "default.html" %}

{% block styles %}
{% endblock %}

{% block conteudo %}

<div class="container">
    <h1>Obras Cadastradas</h1>

    <table class="table">
        <thead>
            <tr class="table-primary">
                <th scope="col">Nome</th>
                <th scope="col">Rua</th>
                <th scope="col">Número</th>
                <th scope="col">Bairro</th>
                <th scope="col">Cidade</th>
            </tr>
        </thead>
        <tbody id="tabelaObras">
            <tr><td colspan="5">Nenhuma obra cadastrada.</td></tr>
        </tbody>
    </table>

   <div class="mt-3">
    <a href="{{ url_for('cadastrarObra') }}" class="btn btn-primary">Cadastrar nova obra</a>
    <button class="btn btn-warning" onclick="alert('Função editar ainda não implementada')">Editar obra</button>
    <button class="btn btn-danger" onclick="alert('Função excluir ainda não implementada')">Excluir obra</button>
</div>
</div>
{% endblock %}

{% endblock %}

{% block scripts %}
<script>
    const tabelaObras = document.getElementById('tabelaObras');

    function atualizarTabela() {
        const obras = JSON.parse(localStorage.getItem('obras')) || [];
        tabelaObras.innerHTML = '';

        if (obras.length === 0) {
            tabelaObras.innerHTML = '<tr><td colspan="5">Nenhuma obra cadastrada.</td></tr>';
            return;
        }

        obras.forEach((obra) => {
            const tr = document.createElement('tr');

            tr.innerHTML = `
                <td>${obra.nome}</td>
                <td>${obra.rua} <button onclick="verNoMapa('${obra.rua}, ${obra.cidade}')">Ver</button></td>
                <td>${obra.numero} <button onclick="verNoMapa('${obra.numero}, ${obra.cidade}')">Ver</button></td>
                <td>${obra.bairro} <button onclick="verNoMapa('${obra.bairro}, ${obra.cidade}')">Ver</button></td>
                <td>${obra.cidade}</td>
            `;

            tabelaObras.appendChild(tr);
        });
    }

    atualizarTabela();
</script>
{% endblock %}
